# Tạo file .github/workflows/auto-merge-request.yml
name: Auto Create Merge Request

on:
  push:
    branches:
      - development  # Trigger khi có push vào branch development

jobs:
  create_merge_request:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0  # Lấy toàn bộ history

      - name: Create Merge Request
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          # Kiểm tra xem đã có PR nào từ development vào main chưa
          existing_pr=$(gh pr list --base main --head development --json number -q '.[0].number')
          
          if [ -z "$existing_pr" ]; then
            # Tạo PR mới nếu chưa có
            gh pr create \
              --base main \
              --head development \
              --title "Merge development into main" \
              --body "Automatically created merge request from development to main branch."
          else
            echo "A pull request from development to main already exists (#$existing_pr)"
          fi
